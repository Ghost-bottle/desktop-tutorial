<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INTJ/INFJ LifeOS Pro</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap');

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            background-color: #050505;
            background-image: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2672&auto=format&fit=crop'); 
            background-size: cover; background-position: center; background-attachment: fixed;
            font-family: 'Noto Sans SC', 'Share Tech Mono', monospace;
            min-height: 100vh;
            color: #d4fce9;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(5,5,10,0.95) 0%, rgba(20,20,30,0.9) 100%);
            z-index: 1;
        }

        .hud-wrapper {
            position: relative; z-index: 2;
            display: flex; gap: 20px;
            width: 1000px; 
            margin: 0 auto;
            padding: 40px;
            min-height: 100vh;
            align-items: flex-start;
        }

        /* ä¾§è¾¹æ  */
        .schedule-panel {
            width: 240px;
            background: rgba(10, 15, 12, 0.8);
            border: 1px solid #334433;
            padding: 20px;
            border-radius: 4px;
            backdrop-filter: blur(5px);
            position: sticky; top: 20px;
        }
        .day-btn {
            display: block; width: 100%;
            padding: 12px 10px; margin-bottom: 8px;
            background: transparent;
            border: 1px solid transparent;
            border-left: 3px solid #444;
            color: #666; cursor: pointer;
            text-align: left; transition: 0.2s;
            font-family: 'Noto Sans SC'; font-weight: bold; font-size: 0.9rem;
        }
        .day-btn:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .day-btn.active {
            background: rgba(51, 255, 153, 0.05);
            border-left: 4px solid #33ff99;
            color: #33ff99;
        }

        /* ä¸»æ§åŒº */
        .status-panel {
            flex: 1;
            background: rgba(10, 12, 15, 0.9);
            border: 1px solid #445566;
            border-radius: 4px;
            padding: 30px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
        }

        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #334433; padding-bottom: 15px; margin-bottom: 20px; }
        .title { font-size: 1.8rem; color: #fff; font-weight: bold; letter-spacing: 2px; }
        .mode-badge { border: 1px solid; padding: 4px 12px; font-size: 0.8rem; font-weight: bold; font-family: 'Share Tech Mono';}

        /* ä»ªè¡¨ç›˜ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .meter-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid #333;
            padding: 15px;
        }

        .meter-label { font-size: 0.75rem; color: #888; margin-bottom: 8px; display: flex; justify-content: space-between; font-family: 'Share Tech Mono'; }
        .track { width: 100%; height: 10px; background: #111; border: 1px solid #444; border-radius: 2px; overflow: hidden; position: relative; }
        
        /* å¢åŠ æ¡çº¹æ•ˆæœï¼Œå¢å¼ºç§‘æŠ€æ„Ÿ */
        .energy-fill { 
            height: 100%; 
            background: repeating-linear-gradient(45deg, #22aa66, #22aa66 10px, #33ff99 10px, #33ff99 20px);
            box-shadow: 0 0 15px rgba(0, 255, 150, 0.2); 
            transition: width 0.3s ease; 
        }
        .psyche-fill { 
            height: 100%; 
            background: repeating-linear-gradient(45deg, #7722aa, #7722aa 10px, #d866ff 10px, #d866ff 20px);
            box-shadow: 0 0 15px rgba(180, 50, 255, 0.3); 
            transition: width 0.3s ease; 
        }

        .control-btn {
            margin-top: 12px; width: 100%;
            background: rgba(255,255,255,0.03); border: 1px solid;
            padding: 12px; cursor: pointer;
            font-family: 'Noto Sans SC'; font-size: 0.85rem; font-weight: bold;
            transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .control-btn:active { transform: scale(0.98); }
        .btn-energy { border-color: #008f8f; color: #00ffff; }
        .btn-psyche { border-color: #8f008f; color: #d866ff; }

        .low-alert { animation: pulse-red 2s infinite; }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 rgba(255,0,0,0); } 50% { box-shadow: 0 0 15px rgba(255, 50, 50, 0.5); } 100% { box-shadow: 0 0 0 rgba(255,0,0,0); } }

        /* ä»»åŠ¡åŒº */
        .section-label { font-size: 0.8rem; color: #666; margin-bottom: 8px; letter-spacing: 1px; font-family: 'Share Tech Mono'; }

        .type1-container {
            padding: 20px; margin-bottom: 25px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid; border-left-width: 5px;
            background: rgba(255,255,255,0.02);
        }
        
        .status-stable { border-color: #224433; border-left-color: #33ff99; } .status-stable .skill-name { color: #33ff99; }
        .status-warning { border-color: #554422; border-left-color: #ffcc00; } .status-warning .skill-name { color: #ffcc00; }
        .status-critical { border-color: #552222; border-left-color: #ff3333; } .status-critical .skill-name { color: #ff3333; }
        .status-done { border-color: #00ffff; border-left-color: #00ffff; background: rgba(0, 255, 255, 0.05); } .status-done .skill-name { color: #00ffff; }

        .btn-group { display: flex; gap: 10px; }
        .action-btn { border: 1px solid; padding: 10px 20px; cursor: pointer; font-family: 'Noto Sans SC'; font-weight: bold; font-size: 0.9rem; background: transparent; }
        
        .btn-stable { color: #33ff99; border-color: #33ff99; } 
        .btn-warning { color: #ffcc00; border-color: #ffcc00; } 
        .btn-critical { color: #ff3333; border-color: #ff3333; } 
        .btn-done { color: #00ffff; border-color: #00ffff; }
        .levelup-btn { border-color: #555; color: #777; }

        .main-mission-box { background: rgba(255, 255, 255, 0.02); border: 1px solid #444; padding: 20px; border-left: 3px solid #aaa; }
        .mission-type { color: #ddd; font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
        .mission-target { color: #aaa; font-size: 0.95rem; }
        .footer-logs { margin-top: 25px; font-size: 0.75rem; color: #555; border-top: 1px solid #222; padding-top: 15px; font-family: 'Share Tech Mono'; }

        /* æ‰‹æœºé€‚é… */
        @media screen and (max-width: 768px) {
            .hud-wrapper { width: 100%; flex-direction: column; padding: 15px; gap: 20px; }
            .schedule-panel { width: 100%; position: relative; order: 2; }
            .status-panel { width: 100%; order: 1; padding: 20px; }
            .dashboard-grid { grid-template-columns: 1fr; gap: 15px; }
            .type1-container { flex-direction: column; align-items: flex-start; gap: 15px; }
            .btn-group { width: 100%; }
            .action-btn { flex: 1; }
            .title { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>

    <div class="hud-wrapper">
        <div class="schedule-panel">
            <div style="margin-bottom:15px; color:#d866ff; font-size:0.85rem; font-family:'Share Tech Mono'">>> CONTROL CENTER</div>
            <button class="day-btn" onclick="renderDay(0)">å‘¨ä¸€ / èƒ¸ç”²é”»é€ </button>
            <button class="day-btn" onclick="renderDay(1)">å‘¨äºŒ / æ•æ·çªè¢­</button>
            <button class="day-btn" onclick="renderDay(2)">å‘¨ä¸‰ / èƒŒéƒ¨å……èƒ½</button>
            <button class="day-btn" onclick="renderDay(3)">å‘¨å›› / æ ¸å¿ƒæ‰“å‡»</button>
            <button class="day-btn" onclick="renderDay(4)">å‘¨äº” / è…¿éƒ¨å¼•æ“</button>
            <button class="day-btn" onclick="renderDay(5)">å‘¨æœ« / è‡ªç”±æ¼«æ¸¸</button>
            <div style="margin-top: 20px; padding-top:15px; border-top:1px solid #333; text-align: center;">
                 <button onclick="resetProgress()" style="background:none; border:none; color:#555; cursor:pointer; font-size:0.75rem;">[ âš  æ ¼å¼åŒ–ç³»ç»Ÿ ]</button>
            </div>
        </div>

        <div class="status-panel" id="main-panel">
            <div class="header">
                <div class="title" id="day-title">æ˜ŸæœŸä¸€</div>
                <div class="mode-badge" id="system-status">SYNCING...</div>
            </div>

            <!-- å®æ—¶ä»ªè¡¨ç›˜ -->
            <div class="dashboard-grid">
                <!-- åŠ¨èƒ½ -->
                <div class="meter-box">
                    <div class="meter-label">
                        <span>âš¡ èº«ä½“æœºèƒ½ (BODY BATTERY)</span>
                        <span id="energy-text">Checking...</span>
                    </div>
                    <div class="track">
                        <div class="energy-fill" id="energy-fill" style="width: 100%;"></div>
                    </div>
                    <button class="control-btn btn-energy" onclick="boostStat('energy')">
                        <span>ğŸ”‹ å°ç¡å……èƒ½ (+15%)</span>
                    </button>
                </div>

                <!-- å¿ƒç¥ -->
                <div class="meter-box">
                    <div class="meter-label">
                        <span style="color:#d866ff">ğŸ”® ç²¾ç¥ç®—åŠ› (MENTAL RAM)</span>
                        <span id="psyche-text" style="color:#d866ff">Checking...</span>
                    </div>
                    <div class="track">
                        <div class="psyche-fill" id="psyche-fill" style="width: 100%;"></div>
                    </div>
                    <button class="control-btn btn-psyche" onclick="boostStat('psyche')">
                        <span>ğŸ§˜â€â™‚ï¸ å†¥æƒ³æ¢å¤ (+20%)</span>
                    </button>
                </div>
            </div>

            <div class="section-label">ä»Šæ—¥ä»»åŠ¡ (Type 1) - <span id="time-display">00:00</span></div>
            
            <div class="type1-container" id="type1-box">
                <div class="skill-info">
                    <div class="skill-name" id="skill-name" style="font-weight:bold; font-size:1.1rem; margin-bottom:5px;">Loading...</div>
                    <div class="skill-step" id="skill-step" style="color:#888; font-size:0.9rem;">...</div>
                </div>
                
                <div class="btn-group">
                    <button class="action-btn levelup-btn" onclick="levelUp()">â–² éš¾åº¦å‡çº§</button>
                    <button class="action-btn" id="finish-btn" onclick="toggleComplete()">æäº¤ä»»åŠ¡</button>
                </div>
            </div>

            <div class="section-label">ä¸»çº¿å‰¯æœ¬ (Type 2/3)</div>
            <div class="main-mission-box">
                <div class="mission-type" id="mission-type">âš”ï¸ ...</div>
                <div class="mission-target" id="mission-target">...</div>
            </div>

            <div class="footer-logs" id="log-text">
                SYSTEM LOG: ç”Ÿç‰©é’ŸåŒæ­¥å®Œæˆã€‚å®æ—¶ç›‘æ§å·²å¼€å¯ã€‚
            </div>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒé…ç½® ---
        const DAY_START = 7; // æ—©ä¸Š7ç‚¹å¼€å§‹æ‰ç”µ
        const DAY_END = 23;  // æ™šä¸Š11ç‚¹å®Œå…¨æ²¡ç”µ
        const TOTAL_MINUTES = (DAY_END - DAY_START) * 60; // æ€»æ¸…é†’æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰

        // --- åŸºç¡€æ•°æ® ---
        const convictSteps = {
            pushups: ["ä¸€å¼: å¢™å£ä¿¯å§æ’‘", "äºŒå¼: ä¸Šæ–œä¿¯å§æ’‘", "ä¸‰å¼: è†ç›–ä¿¯å§æ’‘", "å››å¼: åŠä¿¯å§æ’‘", "äº”å¼: æ ‡å‡†ä¿¯å§æ’‘", "å…­å¼: çª„è·ä¿¯å§æ’‘", "ä¸ƒå¼: åé‡ä¿¯å§æ’‘", "å…«å¼: å•è‡‚åŠä¿¯å§æ’‘", "ä¹å¼: æ æ†ä¿¯å§æ’‘", "åå¼: å•è‡‚ä¿¯å§æ’‘"],
            squats: ["ä¸€å¼: è‚©å€’ç«‹æ·±è¹²", "äºŒå¼: æŠ˜åˆ€æ·±è¹²", "ä¸‰å¼: æ”¯æ’‘æ·±è¹²", "å››å¼: åŠæ·±è¹²", "äº”å¼: æ ‡å‡†æ·±è¹²", "å…­å¼: çª„è·æ·±è¹²", "ä¸ƒå¼: åé‡æ·±è¹²", "å…«å¼: å•è…¿åŠæ·±è¹²", "ä¹å¼: è¾…åŠ©å•è…¿æ·±è¹²", "åå¼: å•è…¿æ·±è¹²"],
            pullups: ["ä¸€å¼: å‚ç›´å¼•ä½“", "äºŒå¼: æ°´å¹³å¼•ä½“", "ä¸‰å¼: æŠ˜åˆ€å¼•ä½“", "å››å¼: åŠå¼•ä½“", "äº”å¼: æ ‡å‡†å¼•ä½“", "å…­å¼: çª„è·å¼•ä½“", "ä¸ƒå¼: åé‡å¼•ä½“", "å…«å¼: å•è‡‚åŠå¼•ä½“", "ä¹å¼: è¾…åŠ©å•è‡‚å¼•ä½“", "åå¼: å•è‡‚å¼•ä½“"],
            legraises: ["ä¸€å¼: åå§¿å±ˆè†", "äºŒå¼: å¹³å§æŠ¬è†", "ä¸‰å¼: å¹³å§å±ˆä¸¾è…¿", "å››å¼: å¹³å§è›™ä¸¾è…¿", "äº”å¼: å¹³å§ç›´ä¸¾è…¿", "å…­å¼: æ‚¬å‚å±ˆè†", "ä¸ƒå¼: æ‚¬å‚å±ˆä¸¾è…¿", "å…«å¼: æ‚¬å‚è›™ä¸¾è…¿", "ä¹å¼: æ‚¬å‚åŠä¸¾è…¿", "åå¼: æ‚¬å‚ä¸¾è…¿"],
            bridges: ["ä¸€å¼: çŸ­æ¡¥", "äºŒå¼: ç›´æ¡¥", "ä¸‰å¼: é«˜ä½æ¡¥", "å››å¼: é¡¶æ¡¥", "äº”å¼: åŠæ¡¥", "å…­å¼: æ ‡å‡†æ¡¥", "ä¸ƒå¼: ä¸‹è¡Œæ¡¥", "å…«å¼: ä¸Šè¡Œæ¡¥", "ä¹å¼: é—­åˆæ¡¥", "åå¼: ç«™ç«‹æ¡¥"],
            hspu: ["ä¸€å¼: é å¢™é¡¶ç«‹", "äºŒå¼: ä¹Œé¸¦å¼", "ä¸‰å¼: é å¢™å€’ç«‹", "å››å¼: åŠå€’ç«‹æ’‘", "äº”å¼: å€’ç«‹æ’‘", "å…­å¼: çª„è·å€’ç«‹æ’‘", "ä¸ƒå¼: åé‡å€’ç«‹æ’‘", "å…«å¼: å•è‡‚åŠå€’ç«‹æ’‘", "ä¹å¼: æ æ†å€’ç«‹æ’‘", "åå¼: å•è‡‚å€’ç«‹æ’‘"]
        };

        const schedule = [
            { day: "ğŸ“… æ˜ŸæœŸä¸€ / MON", skillKey: "pushups", skillName: "æ¨åŠ›ç³» (ä¿¯å§æ’‘)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "èƒ¸éƒ¨ & ä¸‰å¤´è‚Œ" },
            { day: "âš¡ æ˜ŸæœŸäºŒ / TUE", skillKey: "legraises", skillName: "æ ¸å¿ƒç³» (ä¸¾è…¿)", type: "ğŸ”¥ é«˜å¼ºåº¦å¾’æ‰‹", target: "æ ¸å¿ƒ & çˆ†å‘åŠ›" },
            { day: "ğŸ“… æ˜ŸæœŸä¸‰ / WED", skillKey: "pullups", skillName: "æ‹‰åŠ›ç³» (å¼•ä½“)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "èƒŒéƒ¨ & äºŒå¤´è‚Œ" },
            { day: "âš¡ æ˜ŸæœŸå›› / THU", skillKey: "squats", skillName: "ä¸‹è‚¢ç³» (æ·±è¹²)", type: "ğŸ”¥ é«˜å¼ºåº¦å¾’æ‰‹", target: "è…¿éƒ¨ & çºµè·³" },
            { day: "ğŸ“… æ˜ŸæœŸäº” / FRI", skillKey: "hspu", skillName: "è‚©éƒ¨ç³» (å€’ç«‹)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "è‚©éƒ¨æ¨ä¸¾ & è…¿éƒ¨" },
            { day: "ğŸ›Œ å‘¨æœ« / WEEKEND", skillKey: "bridges", skillName: "è„ŠæŸ±ç³» (æ¡¥)", type: "ğŸƒ è‡ªç”±æ¢ç´¢", target: "ä¼‘æ¯ / æˆ·å¤–æ´»åŠ¨" }
        ];

        let userProgress = JSON.parse(localStorage.getItem('fitnessProgress')) || {
            pushups: 0, squats: 0, pullups: 0, legraises: 0, bridges: 0, hspu: 0
        };

        // --- æ ¸å¿ƒé€»è¾‘ï¼šç”Ÿç‰©é’Ÿå®æ—¶è®¡ç®— (Circadian Algorithm) ---
        function getBoosts() {
            // è·å–å½“å¤©çš„é¢å¤–å……èƒ½è®°å½•ï¼Œå¦‚æœä¸æ˜¯ä»Šå¤©åˆ™æ¸…ç©º
            const todayStr = new Date().toDateString();
            let data = JSON.parse(localStorage.getItem('dailyBoosts'));
            if (!data || data.date !== todayStr) {
                return { energy: 0, psyche: 0, date: todayStr };
            }
            return data;
        }

        function saveBoost(type, amount) {
            let data = getBoosts();
            data[type] += amount;
            localStorage.setItem('dailyBoosts', JSON.stringify(data));
            updateMeters();
        }

        function calculateRealTimePercentage(isPsyche = false) {
            const now = new Date();
            const currentHour = now.getHours();
            const currentMin = now.getMinutes();

            // å¦‚æœåœ¨ 0ç‚¹åˆ°7ç‚¹ä¹‹é—´ï¼Œå¼ºåˆ¶ä¸º 100%ï¼ˆç¡çœ æ¢å¤æœŸï¼‰
            if (currentHour < DAY_START) return 100;

            // è®¡ç®—ä»æ—©ä¸Š7ç‚¹åˆ°ç°åœ¨è¿‡äº†å¤šå°‘åˆ†é’Ÿ
            const minutesPassed = ((currentHour - DAY_START) * 60) + currentMin;
            
            // åŸºç¡€è‡ªç„¶è¡°å‡ (Natural Decay)
            // åŠ¨èƒ½æ˜¯çº¿æ€§è¡°å‡ï¼Œå¿ƒç¥è¡°å‡ç¨å¾®å¿«ä¸€ç‚¹(1.1å€)
            let decayFactor = isPsyche ? 1.1 : 1.0; 
            let percentUsed = (minutesPassed / TOTAL_MINUTES) * 100 * decayFactor;
            
            let basePercent = 100 - percentUsed;
            
            // åŠ ä¸Šé¢å¤–å……èƒ½
            const boosts = getBoosts();
            let finalPercent = basePercent + (isPsyche ? boosts.psyche : boosts.energy);

            // é™åˆ¶èŒƒå›´ 0 - 100
            if (finalPercent > 100) finalPercent = 100;
            if (finalPercent < 0) finalPercent = 0;

            return finalPercent;
        }

        function updateMeters() {
            // 1. åŠ¨èƒ½
            const energyVal = calculateRealTimePercentage(false);
            const energyFill = document.getElementById('energy-fill');
            energyFill.style.width = energyVal + "%";
            // ä¿ç•™ä¸€ä½å°æ•°ï¼Œäº§ç”Ÿè·³åŠ¨æ„Ÿ
            document.getElementById('energy-text').innerText = energyVal.toFixed(1) + "%";
            
            if (energyVal < 20) energyFill.classList.add('low-alert');
            else energyFill.classList.remove('low-alert');

            // 2. å¿ƒç¥
            const psycheVal = calculateRealTimePercentage(true);
            const psycheFill = document.getElementById('psyche-fill');
            psycheFill.style.width = psycheVal + "%";
            document.getElementById('psyche-text').innerText = psycheVal.toFixed(1) + "%";

            // çŠ¶æ€æ–‡å­—åé¦ˆ
            const log = document.getElementById('log-text');
            if (psycheVal < 10) log.innerHTML = "âš  è­¦å‘Šï¼šç²¾ç¥åŠ›ä¸¥é‡ä¸è¶³ï¼Œç³»ç»Ÿå³å°†å¼ºåˆ¶ä¼‘çœ ã€‚";
            else if (energyVal < 10) log.innerHTML = "âš  è­¦å‘Šï¼šä½“èƒ½è€—å°½ã€‚å»ºè®®ç«‹å³æ‘„å…¥ç¢³æ°´å¹¶ä¼‘æ¯ã€‚";
        }

        function boostStat(type) {
            // å……èƒ½æŒ‰é’®é€»è¾‘
            if(type === 'energy') {
                if(confirm(">>> è®°å½•ï¼š30åˆ†é’Ÿå°ç¡/è¿›é£Ÿï¼Ÿ\n>>> æ•ˆæœï¼šåŠ¨èƒ½ +15%")) {
                    saveBoost('energy', 15);
                    alert("æœºä½“èƒ½é‡å·²è¡¥å……ã€‚");
                }
            } else {
                if(confirm(">>> è®°å½•ï¼šæ·±åº¦å†¥æƒ³/é˜…è¯»ï¼Ÿ\n>>> æ•ˆæœï¼šå¿ƒç¥ +20%")) {
                    saveBoost('psyche', 20);
                    alert("ç²¾ç¥ç¼“å­˜å·²æ¸…ç†ã€‚");
                }
            }
        }

        // --- ä»»åŠ¡ä¸UIé€»è¾‘ ---
        function updateTimeAndStatus() {
            const now = new Date();
            const hour = now.getHours();
            const minutes = now.getMinutes();
            const todayStr = now.toDateString();
            
            document.getElementById('time-display').innerText = 
                `${String(hour).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;

            const savedStatus = JSON.parse(localStorage.getItem('dailyQuestStatus'));
            const isCompleted = savedStatus && savedStatus.date === todayStr && savedStatus.completed;

            const box = document.getElementById('type1-box');
            const badge = document.getElementById('system-status');
            const btn = document.getElementById('finish-btn');
            const panel = document.getElementById('main-panel');

            box.classList.remove('status-stable', 'status-warning', 'status-critical', 'status-done');
            btn.classList.remove('btn-stable', 'btn-warning', 'btn-critical', 'btn-done');
            panel.style.borderColor = "";

            if (isCompleted) {
                box.classList.add('status-done'); btn.classList.add('btn-done');
                btn.innerText = "ä»Šæ—¥ä»»åŠ¡å®Œæˆ [ âœ” ]";
                badge.innerText = "SYSTEM: OPTIMAL"; badge.style.color = "#00ffff"; badge.style.borderColor = "#00ffff";
            } else {
                btn.innerText = "æäº¤ä»»åŠ¡";
                if (hour < 12) {
                    box.classList.add('status-stable'); btn.classList.add('btn-stable');
                    badge.innerText = "SYSTEM: STABLE"; badge.style.color = "#33ff99"; badge.style.borderColor = "#33ff99";
                } else if (hour >= 12 && hour < 18) {
                    box.classList.add('status-warning'); btn.classList.add('btn-warning');
                    badge.innerText = "SYSTEM: FATIGUE"; badge.style.color = "#ffcc00"; badge.style.borderColor = "#ffcc00";
                    panel.style.borderColor = "#aa8800";
                } else {
                    box.classList.add('status-critical'); btn.classList.add('btn-critical');
                    badge.innerText = "SYSTEM: CRITICAL"; badge.style.color = "#ff3333"; badge.style.borderColor = "#ff3333";
                    panel.style.borderColor = "#882222"; 
                }
            }
        }

        let currentDayIndex = 0;
        
        function toggleComplete() {
            const box = document.getElementById('type1-box');
            if (box.classList.contains('status-done')) return;
            const todayStr = new Date().toDateString();
            localStorage.setItem('dailyQuestStatus', JSON.stringify({ date: todayStr, completed: true }));
            updateTimeAndStatus();
            alert(">>> ä»»åŠ¡å®Œæˆã€‚ç»éªŒå€¼å·²è®°å½•ã€‚");
        }

        function renderDay(index) {
            currentDayIndex = index;
            const data = schedule[index];
            document.querySelectorAll('.day-btn').forEach((btn, i) => btn.classList.toggle('active', i === index));
            document.getElementById('day-title').innerText = data.day;
            document.getElementById('mission-type').innerText = data.type;
            document.getElementById('mission-target').innerText = data.target;
            const currentLevel = userProgress[data.skillKey];
            const skillText = convictSteps[data.skillKey][currentLevel] || "MAX LEVEL";
            document.getElementById('skill-name').innerText = data.skillName;
            document.getElementById('skill-step').innerText = `>>> å½“å‰è¿›åº¦: ${skillText}`;
            updateTimeAndStatus();
            if(window.innerWidth < 768) { document.querySelector('.status-panel').scrollTop = 0; }
        }

        function levelUp() {
            const currentSkillKey = schedule[currentDayIndex].skillKey;
            if (userProgress[currentSkillKey] < 9) {
                userProgress[currentSkillKey]++;
                localStorage.setItem('fitnessProgress', JSON.stringify(userProgress));
                renderDay(currentDayIndex);
            } else { alert("å·²è¾¾åˆ°äººç±»æé™ï¼"); }
        }

        function resetProgress() {
            if(confirm("âš  DANGER: ç¡®è®¤é‡ç½®æ‰€æœ‰æ•°æ®ï¼Ÿ")) { localStorage.clear(); location.reload(); }
        }

        // åˆå§‹åŒ–
        const today = new Date().getDay(); 
        let initIndex = (today === 0) ? 5 : today - 1; 
        if (initIndex < 0) initIndex = 0; 
        renderDay(initIndex);
        
        // å¯åŠ¨å®æ—¶æ—¶é’Ÿ
        updateMeters(); // ç«‹å³æ‰§è¡Œä¸€æ¬¡
        setInterval(() => {
            updateTimeAndStatus();
            updateMeters(); // æ¯ç§’æ›´æ–°ï¼Œç¡®ä¿çœ‹ç€å®ƒåœ¨æ‰ç”µ/è·³åŠ¨
        }, 1000); 

    </script>
</body>
</html>
