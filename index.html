<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- å…³é”®ä¿®æ”¹ï¼šæ·»åŠ è§†å£è®¾ç½®ï¼Œç¡®ä¿æ‰‹æœºä¸ç¼©æ”¾ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INTJ/INFJ LifeOS Mobile</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap');

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            background-color: #050505;
            background-image: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2672&auto=format&fit=crop'); 
            background-size: cover; background-position: center; background-attachment: fixed;
            font-family: 'Noto Sans SC', 'Share Tech Mono', monospace;
            min-height: 100vh;
            color: #d4fce9;
            /* æ‰‹æœºç«¯å…è®¸æ»šåŠ¨ */
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(5,5,10,0.95) 0%, rgba(20,20,30,0.9) 100%);
            z-index: 1;
        }

        .hud-wrapper {
            position: relative; z-index: 2;
            display: flex; gap: 20px;
            /* æ¡Œé¢ç«¯å®½åº¦ */
            width: 1000px; 
            margin: 0 auto;
            padding: 40px;
            height: 100vh;
            align-items: center;
        }

        /* å·¦ä¾§å¯¼èˆª */
        .schedule-panel {
            width: 220px;
            background: rgba(10, 15, 12, 0.8);
            border: 1px solid #334433;
            padding: 20px;
            border-radius: 4px;
            backdrop-filter: blur(5px);
            display: flex; flex-direction: column;
            max-height: 80vh; overflow-y: auto;
        }
        .day-btn {
            display: block; width: 100%;
            padding: 12px 10px; margin-bottom: 8px;
            background: transparent;
            border: 1px solid transparent;
            border-left: 3px solid #444;
            color: #666; cursor: pointer;
            text-align: left; transition: 0.2s;
            font-family: 'Noto Sans SC'; font-weight: bold;
            font-size: 0.9rem;
        }
        .day-btn:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .day-btn.active {
            background: rgba(51, 255, 153, 0.05);
            border-left: 4px solid #33ff99;
            color: #33ff99;
        }

        /* ä¸»é¢æ¿ */
        .status-panel {
            flex: 1;
            background: rgba(10, 12, 15, 0.9);
            border: 1px solid #445566;
            border-radius: 4px;
            padding: 30px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
            transition: border-color 0.5s, box-shadow 0.5s;
            max-height: 90vh; overflow-y: auto;
        }

        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #334433; padding-bottom: 15px; margin-bottom: 20px; }
        .title { font-size: 1.8rem; color: #fff; font-weight: bold; letter-spacing: 2px; }
        .mode-badge { border: 1px solid; padding: 4px 12px; font-size: 0.8rem; font-weight: bold; font-family: 'Share Tech Mono';}

        /* ä»ªè¡¨ç›˜ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .meter-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid #333;
            padding: 15px;
        }

        .meter-label { font-size: 0.75rem; color: #888; margin-bottom: 8px; display: flex; justify-content: space-between; font-family: 'Share Tech Mono'; }
        .track { width: 100%; height: 8px; background: #111; border: 1px solid #444; border-radius: 2px; overflow: hidden; }
        
        .energy-fill { height: 100%; background: linear-gradient(90deg, #33ff99, #00ffff); box-shadow: 0 0 10px rgba(0, 255, 255, 0.3); transition: width 1s linear; }
        .psyche-fill { height: 100%; background: linear-gradient(90deg, #9933ff, #ff00ff); box-shadow: 0 0 10px rgba(180, 50, 255, 0.4); transition: width 1s linear; }

        .control-btn {
            margin-top: 12px; width: 100%;
            background: transparent; border: 1px solid;
            padding: 10px; cursor: pointer; /* æ‰‹æœºç«¯å¢å¤§ç‚¹å‡»åŒºåŸŸ */
            font-family: 'Noto Sans SC'; font-size: 0.8rem;
            transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 5px;
        }
        .btn-energy { border-color: #00ffff; color: #00ffff; opacity: 0.7; }
        .btn-psyche { border-color: #d866ff; color: #d866ff; opacity: 0.7; }

        .low-alert { animation: pulse-opacity 1.5s infinite; }
        @keyframes pulse-opacity { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* ä»»åŠ¡åŒº */
        .section-label { font-size: 0.8rem; color: #666; margin-bottom: 8px; letter-spacing: 1px; font-family: 'Share Tech Mono'; }

        .type1-container {
            padding: 20px; margin-bottom: 25px;
            display: flex; justify-content: space-between; align-items: center;
            transition: all 0.6s ease; border: 1px solid; border-left-width: 5px;
            background: rgba(255,255,255,0.02);
        }
        
        /* çŠ¶æ€é¢œè‰² */
        .status-stable { border-color: #224433; border-left-color: #33ff99; } .status-stable .skill-name { color: #33ff99; }
        .status-warning { border-color: #554422; border-left-color: #ffcc00; } .status-warning .skill-name { color: #ffcc00; }
        .status-critical { border-color: #552222; border-left-color: #ff3333; } .status-critical .skill-name { color: #ff3333; }
        .status-done { border-color: #00ffff; border-left-color: #00ffff; background: rgba(0, 255, 255, 0.05); } .status-done .skill-name { color: #00ffff; }

        .btn-group { display: flex; gap: 10px; }
        .action-btn { border: 1px solid; padding: 8px 15px; cursor: pointer; font-family: 'Noto Sans SC'; font-weight: bold; font-size: 0.85rem; background: transparent; }
        
        .btn-stable { color: #33ff99; border-color: #33ff99; } 
        .btn-warning { color: #ffcc00; border-color: #ffcc00; } 
        .btn-critical { color: #ff3333; border-color: #ff3333; } 
        .btn-done { color: #00ffff; border-color: #00ffff; }
        .levelup-btn { border-color: #555; color: #777; }

        .main-mission-box { background: rgba(255, 255, 255, 0.02); border: 1px solid #444; padding: 20px; border-left: 3px solid #aaa; }
        .mission-type { color: #ddd; font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
        .mission-target { color: #aaa; font-size: 0.95rem; }
        .footer-logs { margin-top: 25px; font-size: 0.75rem; color: #555; border-top: 1px solid #222; padding-top: 15px; font-family: 'Share Tech Mono'; }

        /* --- æ‰‹æœºç«¯å“åº”å¼é€‚é… (Media Query) --- */
        @media screen and (max-width: 768px) {
            body { height: auto; min-height: 100vh; }
            
            .hud-wrapper {
                width: 100%;
                flex-direction: column; /* å˜ä¸ºå‚ç›´æ’åˆ— */
                height: auto;
                padding: 10px;
                gap: 15px;
            }

            /* å¯¼èˆªæ æ”¾åˆ°é¡¶éƒ¨æˆ–è€…æŠ˜å ï¼Œè¿™é‡Œæ”¹ä¸ºç´§å‡‘åˆ—è¡¨ */
            .schedule-panel {
                width: 100%;
                order: 2; /* æ”¾åˆ°ä¸‹é¢ï¼Œä¼˜å…ˆæ˜¾ç¤ºä»ªè¡¨ç›˜ */
                max-height: 300px;
            }
            
            .status-panel {
                width: 100%;
                order: 1; /* ä»ªè¡¨ç›˜åœ¨æœ€ä¸Šé¢ */
                padding: 20px;
                max-height: none;
            }

            .dashboard-grid {
                grid-template-columns: 1fr; /* èƒ½é‡æ¡å‚ç›´æ’åˆ— */
                gap: 10px;
            }

            .type1-container {
                flex-direction: column; /* ä»»åŠ¡å¡ç‰‡å†…å®¹å‚ç›´ */
                align-items: flex-start;
                gap: 15px;
            }
            
            .btn-group {
                width: 100%;
                justify-content: space-between;
            }
            
            .action-btn { flex: 1; text-align: center; }

            .title { font-size: 1.4rem; }
            .header { margin-bottom: 15px; padding-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>

    <div class="hud-wrapper">
        <!-- å¯¼èˆªé¢æ¿ -->
        <div class="schedule-panel">
            <div style="margin-bottom:15px; color:#d866ff; font-size:0.85rem; font-family:'Share Tech Mono'">>> MISSION SELECT</div>
            <button class="day-btn" onclick="renderDay(0)">å‘¨ä¸€ / èƒ¸ç”²é”»é€ </button>
            <button class="day-btn" onclick="renderDay(1)">å‘¨äºŒ / æ•æ·çªè¢­</button>
            <button class="day-btn" onclick="renderDay(2)">å‘¨ä¸‰ / èƒŒéƒ¨å……èƒ½</button>
            <button class="day-btn" onclick="renderDay(3)">å‘¨å›› / æ ¸å¿ƒæ‰“å‡»</button>
            <button class="day-btn" onclick="renderDay(4)">å‘¨äº” / è…¿éƒ¨å¼•æ“</button>
            <button class="day-btn" onclick="renderDay(5)">å‘¨æœ« / è‡ªç”±æ¼«æ¸¸</button>
            <!-- target="_self" è¡¨ç¤ºåœ¨å½“å‰çª—å£æ‰“å¼€ -->
<a href="index2.0.html" style="color: #fff; display:block; padding:10px;">>> è¿›å…¥æ¡£æ¡ˆå®¤</a>
            <div style="margin-top: 20px; text-align: center; padding-top:10px; border-top:1px solid #333;">
                 <button onclick="resetProgress()" style="background:none; border:none; color:#555; cursor:pointer; font-size:0.75rem;">[ âš  æ ¼å¼åŒ–ç³»ç»Ÿ ]</button>
            </div>
        </div>

        <!-- ä¸»é¢æ¿ -->
        <div class="status-panel" id="main-panel">
            <div class="header">
                <div class="title" id="day-title">æ˜ŸæœŸä¸€</div>
                <div class="mode-badge" id="system-status">LOADING...</div>
            </div>

            <!-- åŒä»ªè¡¨ç›˜åŒºåŸŸ -->
            <div class="dashboard-grid">
                <!-- 1. åŠ¨èƒ½ -->
                <div class="meter-box">
                    <div class="meter-label">
                        <span>âš¡ åŠ¨èƒ½ (PHYSICAL)</span>
                        <span id="energy-text">100%</span>
                    </div>
                    <div class="track">
                        <div class="energy-fill" id="energy-fill" style="width: 100%;"></div>
                    </div>
                    <button class="control-btn btn-energy" onclick="rechargeEnergy()">
                        <span>ğŸƒ ä¼‘æ¯ / å……èƒ½</span>
                    </button>
                </div>

                <!-- 2. å¿ƒç¥ -->
                <div class="meter-box">
                    <div class="meter-label">
                        <span style="color:#d866ff">ğŸ”® å¿ƒç¥ (PSYCHE)</span>
                        <span id="psyche-text" style="color:#d866ff">100%</span>
                    </div>
                    <div class="track">
                        <div class="psyche-fill" id="psyche-fill" style="width: 100%;"></div>
                    </div>
                    <button class="control-btn btn-psyche" onclick="rechargePsyche()">
                        <span>ğŸ“˜ å¼€å¯ã€Œç»å¯¹é¢†åŸŸã€</span>
                    </button>
                </div>
            </div>

            <div class="section-label">æ—¥å¸¸ç»´æŠ¤ (Type 1) - <span id="time-display">00:00</span></div>
            
            <div class="type1-container" id="type1-box">
                <div class="skill-info">
                    <div class="skill-name" id="skill-name" style="font-weight:bold; font-size:1.1rem; margin-bottom:5px;">æ¨åŠ›ç³»æŠ€èƒ½</div>
                    <div class="skill-step" id="skill-step" style="color:#888; font-size:0.9rem;">è¯»å–ä¸­...</div>
                </div>
                
                <div class="btn-group">
                    <button class="action-btn levelup-btn" onclick="levelUp()">éš¾åº¦å‡çº§ â–²</button>
                    <button class="action-btn" id="finish-btn" onclick="toggleComplete()">æäº¤ç»´æŠ¤</button>
                </div>
            </div>

            <div class="section-label">ä¸»çº¿å‰¯æœ¬ (Type 2/3)</div>
            <div class="main-mission-box">
                <div class="mission-type" id="mission-type">âš”ï¸ åŠ›é‡è®­ç»ƒ</div>
                <div class="mission-target" id="mission-target">ç›®æ ‡ï¼šèƒ¸éƒ¨ & è‚±ä¸‰å¤´è‚Œ</div>
            </div>

            <div class="footer-logs" id="log-text">
                SYSTEM LOG: ç§»åŠ¨ç»ˆç«¯å·²è¿æ¥ã€‚
            </div>
        </div>
    </div>

    <script>
        // --- ä¿æŒåŸæœ‰çš„ JavaScript é€»è¾‘ï¼Œæ— ç¼è¡”æ¥æ•°æ® ---
        const convictSteps = {
            pushups: ["ä¸€å¼: å¢™å£ä¿¯å§æ’‘", "äºŒå¼: ä¸Šæ–œä¿¯å§æ’‘", "ä¸‰å¼: è†ç›–ä¿¯å§æ’‘", "å››å¼: åŠä¿¯å§æ’‘", "äº”å¼: æ ‡å‡†ä¿¯å§æ’‘", "å…­å¼: çª„è·ä¿¯å§æ’‘", "ä¸ƒå¼: åé‡ä¿¯å§æ’‘", "å…«å¼: å•è‡‚åŠä¿¯å§æ’‘", "ä¹å¼: æ æ†ä¿¯å§æ’‘", "åå¼: å•è‡‚ä¿¯å§æ’‘"],
            squats: ["ä¸€å¼: è‚©å€’ç«‹æ·±è¹²", "äºŒå¼: æŠ˜åˆ€æ·±è¹²", "ä¸‰å¼: æ”¯æ’‘æ·±è¹²", "å››å¼: åŠæ·±è¹²", "äº”å¼: æ ‡å‡†æ·±è¹²", "å…­å¼: çª„è·æ·±è¹²", "ä¸ƒå¼: åé‡æ·±è¹²", "å…«å¼: å•è…¿åŠæ·±è¹²", "ä¹å¼: è¾…åŠ©å•è…¿æ·±è¹²", "åå¼: å•è…¿æ·±è¹²"],
            pullups: ["ä¸€å¼: å‚ç›´å¼•ä½“", "äºŒå¼: æ°´å¹³å¼•ä½“", "ä¸‰å¼: æŠ˜åˆ€å¼•ä½“", "å››å¼: åŠå¼•ä½“", "äº”å¼: æ ‡å‡†å¼•ä½“", "å…­å¼: çª„è·å¼•ä½“", "ä¸ƒå¼: åé‡å¼•ä½“", "å…«å¼: å•è‡‚åŠå¼•ä½“", "ä¹å¼: è¾…åŠ©å•è‡‚å¼•ä½“", "åå¼: å•è‡‚å¼•ä½“"],
            legraises: ["ä¸€å¼: åå§¿å±ˆè†", "äºŒå¼: å¹³å§æŠ¬è†", "ä¸‰å¼: å¹³å§å±ˆä¸¾è…¿", "å››å¼: å¹³å§è›™ä¸¾è…¿", "äº”å¼: å¹³å§ç›´ä¸¾è…¿", "å…­å¼: æ‚¬å‚å±ˆè†", "ä¸ƒå¼: æ‚¬å‚å±ˆä¸¾è…¿", "å…«å¼: æ‚¬å‚è›™ä¸¾è…¿", "ä¹å¼: æ‚¬å‚åŠä¸¾è…¿", "åå¼: æ‚¬å‚ä¸¾è…¿"],
            bridges: ["ä¸€å¼: çŸ­æ¡¥", "äºŒå¼: ç›´æ¡¥", "ä¸‰å¼: é«˜ä½æ¡¥", "å››å¼: é¡¶æ¡¥", "äº”å¼: åŠæ¡¥", "å…­å¼: æ ‡å‡†æ¡¥", "ä¸ƒå¼: ä¸‹è¡Œæ¡¥", "å…«å¼: ä¸Šè¡Œæ¡¥", "ä¹å¼: é—­åˆæ¡¥", "åå¼: ç«™ç«‹æ¡¥"],
            hspu: ["ä¸€å¼: é å¢™é¡¶ç«‹", "äºŒå¼: ä¹Œé¸¦å¼", "ä¸‰å¼: é å¢™å€’ç«‹", "å››å¼: åŠå€’ç«‹æ’‘", "äº”å¼: å€’ç«‹æ’‘", "å…­å¼: çª„è·å€’ç«‹æ’‘", "ä¸ƒå¼: åé‡å€’ç«‹æ’‘", "å…«å¼: å•è‡‚åŠå€’ç«‹æ’‘", "ä¹å¼: æ æ†å€’ç«‹æ’‘", "åå¼: å•è‡‚å€’ç«‹æ’‘"]
        };

        const schedule = [
            { day: "ğŸ“… æ˜ŸæœŸä¸€ / MON", skillKey: "pushups", skillName: "æ¨åŠ›ç³» (ä¿¯å§æ’‘)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "èƒ¸éƒ¨ & ä¸‰å¤´è‚Œ" },
            { day: "âš¡ æ˜ŸæœŸäºŒ / TUE", skillKey: "legraises", skillName: "æ ¸å¿ƒç³» (ä¸¾è…¿)", type: "ğŸ”¥ é«˜å¼ºåº¦å¾’æ‰‹", target: "æ ¸å¿ƒ & çˆ†å‘åŠ›" },
            { day: "ğŸ“… æ˜ŸæœŸä¸‰ / WED", skillKey: "pullups", skillName: "æ‹‰åŠ›ç³» (å¼•ä½“)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "èƒŒéƒ¨ & äºŒå¤´è‚Œ" },
            { day: "âš¡ æ˜ŸæœŸå›› / THU", skillKey: "squats", skillName: "ä¸‹è‚¢ç³» (æ·±è¹²)", type: "ğŸ”¥ é«˜å¼ºåº¦å¾’æ‰‹", target: "è…¿éƒ¨ & çºµè·³" },
            { day: "ğŸ“… æ˜ŸæœŸäº” / FRI", skillKey: "hspu", skillName: "è‚©éƒ¨ç³» (å€’ç«‹)", type: "ğŸ›¡ï¸ åŠ›é‡è®­ç»ƒ", target: "è‚©éƒ¨æ¨ä¸¾ & è…¿éƒ¨" },
            { day: "ğŸ›Œ å‘¨æœ« / WEEKEND", skillKey: "bridges", skillName: "è„ŠæŸ±ç³» (æ¡¥)", type: "ğŸƒ è‡ªç”±æ¢ç´¢", target: "ä¼‘æ¯ / æˆ·å¤–æ´»åŠ¨" }
        ];

        let userProgress = JSON.parse(localStorage.getItem('fitnessProgress')) || {
            pushups: 0, squats: 0, pullups: 0, legraises: 0, bridges: 0, hspu: 0
        };

        const ENERGY_DURATION = 3 * 60 * 60 * 1000;
        
        function updateEnergy() {
            const now = Date.now();
            let lastCharge = localStorage.getItem('lastEnergyCharge');
            if (!lastCharge) { lastCharge = now; localStorage.setItem('lastEnergyCharge', now); }

            const elapsed = now - parseInt(lastCharge);
            let percent = 100 - (elapsed / ENERGY_DURATION * 100);
            if (percent < 0) percent = 0;

            const fill = document.getElementById('energy-fill');
            fill.style.width = percent + "%";
            document.getElementById('energy-text').innerText = Math.floor(percent) + "%";
            
            if (percent < 20) fill.classList.add('low-alert');
            else fill.classList.remove('low-alert');
        }

        function rechargeEnergy() {
            localStorage.setItem('lastEnergyCharge', Date.now());
            updateEnergy();
        }

        const PSYCHE_DURATION = 6 * 60 * 60 * 1000; 

        function updatePsyche() {
            const now = Date.now();
            let lastCharge = localStorage.getItem('lastPsycheCharge');
            if (!lastCharge) { lastCharge = now; localStorage.setItem('lastPsycheCharge', now); }

            const elapsed = now - parseInt(lastCharge);
            let percent = 100 - (elapsed / PSYCHE_DURATION * 100);
            if (percent < 0) percent = 0;

            const fill = document.getElementById('psyche-fill');
            fill.style.width = percent + "%";
            document.getElementById('psyche-text').innerText = Math.floor(percent) + "%";
            
            const log = document.getElementById('log-text');
            if (percent === 0) {
                log.style.color = "#d866ff";
                log.innerHTML = "SYSTEM ALERT: ç²¾ç¥åŠ›æ¯ç«­ã€‚è¯·ç«‹å³ç‹¬å¤„ã€‚";
                fill.classList.add('low-alert');
            } else if (percent < 30) {
                log.style.color = "#aaa";
            }
        }

        function rechargePsyche() {
            if(confirm(">>> ç¡®è®¤å¼€å¯ã€Œç»å¯¹é¢†åŸŸã€ï¼Ÿ\n\næŒ‡ä»¤ï¼šå±è”½å™ªéŸ³ï¼Œæ·±åº¦ç‹¬å¤„ã€‚\nå»ºè®®æ—¶é•¿ï¼š30åˆ†é’Ÿä»¥ä¸Šã€‚")) {
                localStorage.setItem('lastPsycheCharge', Date.now());
                updatePsyche();
                alert(">>> ç²¾ç¥è¿æ¥å·²é‡ç½®ã€‚");
            }
        }

        function updateTimeAndStatus() {
            const now = new Date();
            const hour = now.getHours();
            const minutes = now.getMinutes();
            const todayStr = now.toDateString();
            
            document.getElementById('time-display').innerText = 
                `${String(hour).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;

            const savedStatus = JSON.parse(localStorage.getItem('dailyQuestStatus'));
            const isCompleted = savedStatus && savedStatus.date === todayStr && savedStatus.completed;

            const box = document.getElementById('type1-box');
            const badge = document.getElementById('system-status');
            const btn = document.getElementById('finish-btn');
            const log = document.getElementById('log-text');
            const panel = document.getElementById('main-panel');

            box.classList.remove('status-stable', 'status-warning', 'status-critical', 'status-done');
            btn.classList.remove('btn-stable', 'btn-warning', 'btn-critical', 'btn-done');
            panel.style.borderColor = ""; panel.style.boxShadow = "";

            if (isCompleted) {
                box.classList.add('status-done'); btn.classList.add('btn-done');
                btn.innerText = "ä»Šæ—¥ç»´æŠ¤å®Œæˆ";
                badge.innerText = "STATUS: OPTIMAL"; badge.style.color = "#00ffff"; badge.style.borderColor = "#00ffff";
                if(document.getElementById('psyche-text').innerText !== "0%") {
                     log.innerHTML = "SYSTEM LOG: æœºä½“æœºèƒ½æ­£å¸¸ã€‚";
                     log.style.color = "#555";
                }
            } else {
                btn.innerText = "æ‰§è¡Œç»´æŠ¤";
                if (hour < 12) {
                    box.classList.add('status-stable'); btn.classList.add('btn-stable');
                    badge.innerText = "STATUS: STABLE"; badge.style.color = "#33ff99"; badge.style.borderColor = "#33ff99";
                } else if (hour >= 12 && hour < 18) {
                    box.classList.add('status-warning'); btn.classList.add('btn-warning');
                    badge.innerText = "STATUS: WARNING"; badge.style.color = "#ffcc00"; badge.style.borderColor = "#ffcc00";
                    panel.style.borderColor = "#aa8800";
                } else {
                    box.classList.add('status-critical'); btn.classList.add('btn-critical');
                    badge.innerText = "STATUS: CRITICAL"; badge.style.color = "#ff3333"; badge.style.borderColor = "#ff3333";
                    panel.style.borderColor = "#882222"; 
                }
            }
        }

        let currentDayIndex = 0;
        
        function toggleComplete() {
            const box = document.getElementById('type1-box');
            if (box.classList.contains('status-done')) return;
            const todayStr = new Date().toDateString();
            localStorage.setItem('dailyQuestStatus', JSON.stringify({ date: todayStr, completed: true }));
            updateTimeAndStatus();
            alert(">>> ç»´æŠ¤å®Œæˆã€‚");
        }

        function renderDay(index) {
            currentDayIndex = index;
            const data = schedule[index];
            document.querySelectorAll('.day-btn').forEach((btn, i) => btn.classList.toggle('active', i === index));
            document.getElementById('day-title').innerText = data.day;
            document.getElementById('mission-type').innerText = data.type;
            document.getElementById('mission-target').innerText = data.target;
            const currentLevel = userProgress[data.skillKey];
            const skillText = convictSteps[data.skillKey][currentLevel] || "MAX LEVEL";
            document.getElementById('skill-name').innerText = data.skillName;
            document.getElementById('skill-step').innerText = `>>> å½“å‰: ${skillText}`;
            updateTimeAndStatus();
            
            // æ‰‹æœºç«¯ä¼˜åŒ–ï¼šç‚¹å‡»èœå•åè‡ªåŠ¨æ»šå›åˆ°é¡¶éƒ¨çœ‹ä»»åŠ¡
            if(window.innerWidth < 768) {
               document.querySelector('.status-panel').scrollTop = 0;
            }
        }

        function levelUp() {
            const currentSkillKey = schedule[currentDayIndex].skillKey;
            if (userProgress[currentSkillKey] < 9) {
                userProgress[currentSkillKey]++;
                localStorage.setItem('fitnessProgress', JSON.stringify(userProgress));
                renderDay(currentDayIndex);
            } else { alert("å·²è¾¾åˆ°æœ€é«˜ç­‰çº§ï¼"); }
        }

        function resetProgress() {
            if(confirm("âš  ç¡®è®¤æ ¼å¼åŒ–æ‰€æœ‰æ•°æ®ï¼Ÿ")) { localStorage.clear(); location.reload(); }
        }

        const today = new Date().getDay(); 
        let initIndex = (today === 0) ? 5 : today - 1; 
        if (initIndex < 0) initIndex = 0; 
        renderDay(initIndex);
        
        updateEnergy();
        updatePsyche();
        setInterval(updateTimeAndStatus, 60000);
        setInterval(updateEnergy, 60000); 
        setInterval(updatePsyche, 60000);
    </script>
</body>
</html>

